\subsection{Cospans of hypergraphs}

String diagrams also have \emph{input} and \emph{output} interfaces.
(Labelled) hypergraphs may have suggestively dangling nodes in the pictures,
but this is not actually encoded in the definition, and moreover we may wish to
set a non-dangling node as an input or output.
To set the interfaces of a hypergraph, hypergraph homomorphisms are used
to `pick' the appropriate nodes.

\begin{definition}[Cospan]
    A \emph{cospan} in a category \(\mcc\) is a pair of morphisms \(X \to A\)
    and \(X \to B\), written \(\cospan{X}{A}{Y}\).
    A \emph{cospan morphism} \(
        (\cospan{X}[f]{A}[g]{Y}) \to (\cospan{X}[h]{B}[k]{Y})
    \) is a morphism \(\morph{\alpha}{A}{B}\) in \(\mcc\)
    such that the following diagram commutes:
    %
    \begin{center}
        \includestandalone{figures/category/diagrams/cospan-morphism}
    \end{center}
    %
    Two cospans \(\cospan{X}{A}{Y}\) and \(\cospan{X}{B}{Y}\) are
    \emph{isomorphic} if there exists a morphism of cospans as above where
    \(\alpha\) is an isomorphism.
\end{definition}

For our intended purpose, the `legs' of cospans will be the interfaces and the
`apex' will be the hypergraph we are providing interfaces for.
This means we require a categorical setting in which the objects are
\emph{cospans} of hypergraphs, so a notion of \emph{composition} of cospans
must be provided.

\begin{definition}[Composition of cospans]
    \label{def:cospan-composition}
    In a category \(\mcc\) with pushouts, the composition of cospans
    \(\cospan{X}[f]{A}[g]{Y}\) and \(\cospan{Y}[h]{B}[k]{Z}\) is by pushout:
    \begin{center}
        \includestandalone{figures/category/diagrams/cospan-composition}
    \end{center}
\end{definition}

\begin{definition}[Categories of cospans]
    Let \(\mcc\) be a category with pushouts and an initial object.
    The category of cospans over \(\mathbf{C}\), denoted \(\csp{\mathbf{C}}\),
    has as objects the objects of \(\mathbf{C}\) and as morphisms \(A \to B\)
    the isomorphism classes of cospans \(\cospan{A}{X}{B}\) for some
    \(X \in \mcc\).
    Composition is by pushout as detailed in \cref{def:cospan-composition} and
    the identity is \(X \xrightarrow{\id[X]} X \xleftarrow{\id[X]} X\).
\end{definition}

\begin{lemma}
    For a category \(\mcc\) with pushouts and an initial object,
    \(\csp{\mcc}\) is symmetric monoidal with the tensor given by the
    coproduct in \(\mcc\), the monoidal unit given by the initial object
    \(0 \in \mathbf{C}\), and the symmetry defined as the cospan
    \(\cospan{A+B}{A+B}{B+A}\).
\end{lemma}
\begin{proof}
    It is a simple exercise to check that the equations of SMCs hold.
\end{proof}



As mentioned above, the legs of the cospan will act as the interfaces of the
hypergraph.
But not any old hypergraph can act as an interface to a hypergraph; what would
it mean to have an edge as an input?
We must restrict

\begin{definition}[Discrete hypergraph]
    A \emph{discrete hypergraph} is a hypergraph in which each edge set is
    empty.
\end{definition}

Discrete hypergraphs will act as the legs of cospans; the categorical
infrastructure required to enforce this will be described in the next section.

\subsection{Ordering the interfaces}

Even though our hypergraphs still have input and output interfaces specified
using cospans, there is still information missing: what is the \emph{ordering}
of the vertices in these interfaces?
Without this data \(\csp{\hypsigmac}\) is not even a PROP.

A cospan \(\cospan{M}{F}{N}\) is a morphism
\(M \to N \in \csp{\hypsigmac}\); we need to ensure that the legs of each
cospan of hypergraphs can be viewed as a word in \(\freemon{C}\) for some
countable set of colours \(C\).
This is formally performed by another functor.

\begin{theorem}[\cite{bonchi2022string}, Thm. 3.6]
    Let \(\mathbb{X}\) be a coloured PROP whose monoidal product is a coproduct,
    \(\mathbf{C}\) a category with pushouts and an initial object, and \(
        \morph{F}{\mathbb{X}}{\mathbf{C}}
    \) a coproduct-preserving functor.
    Then there exists a coloured PROP \(\csp[F]{\mathbf{C}}\) whose arrows
    \(\listvar{m} \to \listvar{n}\) are isomorphism classes of \(\mathbf{C}\)
    cospans \(\cospan{F\listvar{m}}{C}{F\listvar{n}}\).
\end{theorem}
\begin{proof}
    Composition is given by pushout.
    Note that \(F(\listvar{mp}) \cong F\listvar{m} + F(\listvar{p})\) and
    \(F(\listvar{nq}) \cong F(\listvar{n}) + F(\listvar{q})\) because \(F\)
    preserves coproducts; subsequently for cospans
    \(\cospan{F\listvar{m}}{C}{F\listvar{n}}\) and
    \(\cospan{F\listvar{p}}{C}{F\listvar{q}}\), their
    coproduct is given by \(
        \cospan{F\listvar{m} + F\listvar{p}}{C + D}{F\listvar{p} + F\listvar{q}}
    \).
    Symmetries in \(\mathbb{X}\) are determined by the universal property of
    the coproduct; they are inherited by \(\csp[F]{\mathbf{C}}\) because \(F\)
    preserves coproducts.
\end{proof}

\(F\) is the functor that imbues the objects in the legs of the cospan with the
structure of words in some coloured PROP \(\mathbb{X}\).
In our case, this PROP will be the PROP of coloured countable sets; we will
start building this from the well-known PROP of finite sets.

\begin{definition}
    Let \(\finsetprop\) be the PROP with morphisms \(m \to n\) the functions
    between finite sets \([m] \to [n]\).
\end{definition}

\(\finsetprop\) is a (monochromatic) PROP; for finite sets of colours \(\mcc\),
objects \([m] \in \finsetprop\) are coloured using morphisms \([m] \to \mcc\),
suggesting another slice construction.
Since we are working with potentially countably infinite sets of colours, the
definition of \(\finsetprop\) must first be tweaked.

\begin{definition}
    Let \(\finsetpropwithnat\) be the category \(\finsetprop\) augmented with the
    set of natural numbers and the functions \([m] \to \nat\) for each finite
    set \([m]\).
\end{definition}

Adding in morphisms \([m] \to \nat\) allows for colourings with countably
infinite sets of colours; the PROP of finite sets \emph{coloured} over some
countable set \(C\) is the slice \(\finsetpropwithnat \slice C\).
Objects of this category are pairs \(([m], \morph{w}{[m]}{C})\); this pair can
be viewed as a word in \(\freemon{C}\) of length \(m\), with the \(i\)th letter
as \(w(i)\).

\begin{remark}
    Note that we do not include the morphisms \(\nat \to [m]\) in
    \(\finsetpropwithnat\); this is because when we view objects of
    \(\finsetpropwithnat \slice C\) as words in \(\freemon{C}\), we still only
    want to consider finite words despite there being potentially countably
    infinite colours.
\end{remark}

All that remains is to verify that \(\finsetpropwithnat \slice C\) is indeed a
coloured PROP.
To assist in this endeavour, we recall a property of slice categories.

\begin{lemma}
    \label{lem:slice-coproducts}
    For a category \(\mcc\) with coproducts, \(\mcc \slice X\) has coproducts.
\end{lemma}
\begin{proof}
    Let \(A,B,X\) be objects in \(\mcc\); as \(\mcc\) has coproducts \(A + B\)
    is also an object in \(\mcc\).
    Then the coproduct of \((A, A \to X)\) and \((B, B \to X)\) in
    \(\mcc \slice X\) is \(A + B \to X\); the universal morphism is \([f, g]\).
\end{proof}

Following the strategy of \cite[Prop. 2.23]{bonchi2022string}, we can now show
that \(\finsetpropwithnat \slice C\) is a coloured PROP.

\begin{proposition}
    \label{prop:hatfinsetprop-slice-is-coloured-prop}
    For a countable set \(C\), \(\finsetpropwithnat \slice C\) is a
    coloured PROP.
\end{proposition}
\begin{proof}
    As established, the objects of \(\finsetpropwithnat \slice C\) can be viewed
    as words in \(\freemon{C}\).
    As slice categories preserve coproducts by \cref{lem:slice-coproducts},
    \(\finsetpropwithnat \slice C\) is strict symmetric monoidal, and the
    coproduct acts as concatenation of words.
\end{proof}

We can now state the functor used to assemble interfaces of hypergraphs into
words.

\begin{definition}[\cite{bonchi2022string}, Rem. 3.12]
    Let \(\morph{\pickinterfacesc{C}}{\finsetpropwithnat \slice C}{\hypsigmac}\)
    be defined as functor sending a word \(\overline{n}\) to the corresponding
    discrete coloured hypergraph containing vertices coloured as in
    \(\overline{n}\), and sending a function \(\overline{m} \to \overline{n}\)
    to the induced homomorphism of discrete hypergraphs.
\end{definition}

Subsequently we obtain a coloured PROP \(
    \csp[\pickinterfacesc{C}]{\hypsigmac}
\), which will serve as the domain in which we interpret string diagrams
combinatorially.

\begin{example}
    Recall the labelled hypergraph \(F\) from \cref{ex:labelled-hypergraph}.
    We assign interfaces to it as the cospan \(\cospan{3}[f]{F}[g]{3}\), where
    \begin{gather*}
        f(D0) = v_0 \quad f(D1) = v_1 \\
        g(D0) = v_4 \quad g(D1) = v_1 \quad g(D2) = v_4
    \end{gather*}
    Interfaces are drawn on the left and right of a main graph, with numbers
    illustrating the action of the cospan maps.
    \[
        \iltikzfig{graphs/example-interfaces-coloured}
    \]
    For clarity, we number the outputs after the inputs, but this does not
    reflect the mapping performed by \(D\).

    Composition in \(\cspdhyp\) is by pushout; effectively the vertices in the
    output of the first cospan are `glued together' with the inputs of the
    second.
    \[
        \iltikzfig{graphs/example-interfaces-coloured}
        \seq
        \iltikzfig{graphs/example-2-interfaces-coloured}
        =
        \iltikzfig{graphs/example-composition-coloured}
    \]
    Tensor in \(\cspdhyp\) is by direct product; putting cospans on top of each
    other.
    \[
        \iltikzfig{graphs/example-interfaces-coloured}
        \tensor
        \iltikzfig{graphs/example-2-interfaces-coloured}
        =
        \iltikzfig{graphs/example-tensor-coloured}
    \]
\end{example}