\section{Frobenius terms as hypergraphs}

It is now time to establish the correspondences between cospans of hypergraphs
and string diagrams.
We will first recount the constructions used by Bonchi et al in
\cite{bonchi2022string} for settings with a Frobenius structure before showing
how we can use their ingredients for a \emph{traced} setting either with or
without a comonoid structure.

\subsection{Hypergraph categories}

Monoids and comonoids are structures that crop up all over mathematics.
However, things become really interesting when multiple such structures
\emph{interact}.
One particular combination of a monoid and comonoid structure is known as a
\emph{Frobenius structure}; such structures are particularly relevant to us
because symmetric monoidal terms equipped with a Frobenius structure correspond
precisely to the cospans of hypergraphs defined in the previous section.

\begin{definition}
    \label{def:frob}
    The monoidal theory of \emph{special commutative Frobenius algebras} is
    defined as \((\generators[\frob], \equations[\frob])\), where \(
        \generators[\frob] := \{
            \iltikzfig{strings/structure/monoid/merge}[colour=white],
            \iltikzfig{strings/structure/monoid/init}[colour=white],
            \iltikzfig{strings/structure/comonoid/copy}[colour=white],
            \iltikzfig{strings/structure/comonoid/discard}[colour=white]
        \}
    \) and the equations of \(\equations[\frob]\) are listed in
    \cref{fig:frobenius-equations}.
    We write \(\frob := \smc{\generators[\frob], \equations[\frob]}\).
\end{definition}

\input{floats/frobenius}

The equations of special Frobenius algebras include those of commutative monoids and
commutative comonoids along with the `Frobenius equation' and the
`special equation'.

\(\frob\) is a monochromatic PROP.
To define a \emph{coloured} version of \(\frob\) we simply use a different copy
of \(\frob\) to represent each colour, using a fact about \(\prop\) and
\(\cprop\).

\begin{theorem}[\cite{baez2018props}, Corollary 5.3]
    \(\prop\) has coproducts.
\end{theorem}

This easily generalises to \(\cprop\) by replacing natural numbers with words.
This means that given coloured PROPs \(\mcc\) and \(\mcd\) with objects the
words in \(\freemon{C}\) and \(\freemon{D}\) respectively, there is also a
coloured PROP \(\mcc + \mcd\) with objects the words in \(\freemon{(C + D)}\)
and morphisms defined in the obvious way.
We can use this to define a multi-coloured version of \(\frob\) as
a coproduct of copies of \(\frob\).

\begin{definition}[\cite{bonchi2022string}]
    \label{def:frobc}
    For a countable set of colours \(C\), let \(\frobc{C} \in \cprop\) be
    defined as \(\frobc{C} := \sum_{c \in C}\frob\).
\end{definition}

Frobenius structures have turned out to be very useful in studying compositional
processes such as quantum processes~\cite{coecke2008interacting} and signal flow
graphs~\cite{bonchi2014categorical,bonchi2015full}.
As with other structures, it is useful to talk about the categorical setting in
which \emph{every} object in a category is equipped with such a structure.

\begin{definition}[Hypergraph category~\cite{fong2019hypergraph}]
    \label{def:hypergraph-category}
    A \emph{hypergraph category} is a category in which every object is equipped
    with a special commutative Frobenius algebra subject to the
    \emph{coherence equations} in \cref{fig:hypergraph-coherence}.
\end{definition}

\input{floats/hypergraph-coherence}

\begin{remark}
    The notion of a hypergraph category is so natural that it has been
    rediscovered numerous times over the years!
    They were originally called \emph{well-supported compact closed categories}
    by Carboni and Walters~\cite{carboni1987cartesian}, and have subsequently
    appeared as
    \emph{dgs-monoidal categories}~\cite{katis1997bicategories,gadducci1998inductive,gadducci1999bicategorical,bruni2002normal}
    and \emph{dungeon categories}~\cite{morton2014belief}.
    The term \emph{hypergraph categories} was coined more recently but has
    become the standard in the compositional processes
    community~\cite{kissinger2015finite,fong2015decorated,baez2016compositional,baez2018compositional}.
\end{remark}

As the Frobenius structure is their entire raison d'\^{e}tre, it is unsurprising
that two examples of hypergraph categories are the PROPs defined in
\cref{def:frob} and \cref{def:frobc}.

\begin{lemma}
    \(\frob\) and \(\frobc{C}\) are hypergraph categories.
\end{lemma}
\begin{proof}
    The generators in \(\frob\) and \(\frobc{C}\) provide the Frobenius
    structure for the object \(1\) in the former and the base colours
    \(c \in C\) in the latter.
    The Frobenius structure for the other objects constructed through
    \(\tensor\) can be derived by parallel composition, following the recipes
    given in the coherence equations in \cref{fig:hypergraph-coherence}.
\end{proof}

When we say `Frobenius terms', what we really mean to say is that we are
working with terms in a hypergraph category freely generated over some
generators.

\begin{definition}
    For a set of colours \(C\) and generators \(\generators\), let
    \(\hypc{C,\generators}\) be the coloured PROP freely generated over the
    generators in \(\generators\) and those in \(\frobc{C}\).
\end{definition}

There is a simple observation to be made about \(\hypcsigmac\).

\begin{lemma}
    \(\hypcsigmac \cong \smcsigmac + \frobc{C}\)
\end{lemma}
\begin{proof}
    Every term in \(\hypcsigmac\) can be expressed as a combination of
    generators either in \(\smcsigmac\) or \(\frobc{C}\).
\end{proof}

Viewing \(\hypcsigmac\) as a coproduct in \(\cprop\) will prove to be beneficial
when establishing a correspondence between \(\hypcsigmac\) and \(\cspdchyp\) in
the upcoming sections.

\subsection{Hypergraph categories and hypergraphs}

Perhaps confusingly, the category of \emph{hypergraphs} \(\hypsigmac\) is
\emph{not} a hypergraph category, but the category of \emph{cospans} of
hypergraphs is!
To show this, we exploit a correspondence between \(\frob\) and PROPs of
\emph{finite sets}.

\begin{proposition}[\cite{lack2004composing}, Ex. 5.4]
    \label{prop:frob-finset}
    There is an isomorphism of PROPs \(\frob \cong \csp{\finsetprop}\).
\end{proposition}

We omit the formal proof and sketch the correspondence between the two
categories.
Terms in \(\frob\) are formed of all the ways of combining \(
    \iltikzfig{strings/structure/monoid/merge}[colour=white],
    \iltikzfig{strings/structure/monoid/init}[colour=white],
    \iltikzfig{strings/structure/comonoid/copy}[colour=white],
    \iltikzfig{strings/structure/comonoid/discard}[colour=white],
    \iltikzfig{strings/category/identity}[colour=white],
\) and \(
    \iltikzfig{strings/symmetric/symmetry}[colour=white]
\) in sequence and parallel, so a string diagram for a term \(\morph{f}{m}{n}\)
is depicted as \(x\) connected components drawing paths from \(m\) inputs to
\(n\) outputs, as illustrated with the example below.

\begin{center}
    \iltikzfig{strings/structure/frobenius/example}
\end{center}

Note there is no requirement for each component to connect to one or both
interfaces as the \(
    \iltikzfig{strings/structure/monoid/init}[colour=white]
\) and \(
    \iltikzfig{strings/structure/comonoid/discard}[colour=white]
\) generators can introduce and stub wires.
A term \(\morph{f}{m}{n}\) with \(x\) connected components corresponds to
a cospan of finite sets \(\cospan{[m]}[i]{[x]}[j]{[n]}\), where the functions
\(i\) and \(j\) map the inputs and outputs to the components they connect to.

\begin{example}
    Consider the term \(\morph{f}{5}{4}\) drawn on the left below.
    This corresponds to a cospan \(\cospan{[5]}{[3]}{[4]}\) as shown on the
    right below.
    \begin{center}
        \iltikzfig{strings/structure/frobenius/example}
        \(\Leftrightarrow\)
        \scalebox{0.75}{\tikzfig{strings/structure/frobenius/example-cospan}}
    \end{center}
\end{example}

The cospan representation shows how all connected Frobenius structures can be
`squished' into a single blob.
For \(\frobc{C}\) we replace \(\finsetprop\) with the coloured version
\(\finsetpropwithnat \slice C\) seen in the previous section.
A coloured version of \cref{prop:frob-finset} was shown for a \emph{finite} set
of colours in \cite{bonchi2022string}; we recall its proof before extending this
to the \emph{countable} setting we work in.

\begin{theorem}[\cite{bonchi2022string}, Theorem 2.24]
    \label{thm:frobc-iso-finset-slice-c}
    For a finite set of colours \(C \in \finsetprop\), there is an isomorphism
    of coloured PROPs \(\frobc{C} \cong \csp{\finsetprop \slice C}\).
\end{theorem}
\begin{proof}
    By definition of \(\frobc{C}\),
    \cref{def:frobc,prop:frob-finset,lem:slice-iso-terminal}
    we have that \[
        \frobc{C}
        :=
        \sum_{c \in C}\frob
        \cong
        \sum_{c \in C}\csp{\finsetprop}
        \cong
        \sum_{c \in C}\csp{\finsetprop \slice 1}
    \]
    In the other direction we have that \(
        \csp{\finsetprop \slice C}
        \cong
        \csp{\finsetprop \slice \sum_{c \in C} 1}
    \) as \(C\) is countable.
    So we need to show that \(
        \sum_{c \in C}\csp{\finsetprop \slice 1}
        \cong
        \csp{\finsetprop \slice \sum_{c \in C} 1}
    \).
    The objects of the former are coproducts of objects in
    \(\finsetprop \slice C\); as this is a coloured prop the coproduct is
    concatenation and subsequently the objects can be viewed as words in
    \(\freemon{C}\).
    Similarly, the objects of the latter are objects of
    \(\finsetprop \slice \sum_{c \in C} 1\), which can clearly also be
    seen as words in \(\freemon{C}\).

    The morphisms of the former are coproducts of cospans, which can
    equivalently be viewed as a single cospan with coproducts in the legs and
    apex; using the reasoning above this means it is a cospan of words in
    \(\freemon{C}\); it is easy to see that this is also the case for morphisms
    in the latter.
\end{proof}

We need to show a version of this for the case where \(C\) may be
\emph{countably infinite}.

\begin{lemma}
    \label{lem:slice-iso-terminal}
    In a category \(\mcc\) with a terminal object \(1\),
    \(\mcc \cong \mcc \slice 1\).
\end{lemma}
\begin{proof}
    Since \(1\) is terminal, there is a unique morphism \(A \to 1\) for each
    object \(A\) in \(\mcc\), so there is an object \((A, A \to 1)\) in
    \(\mcc \slice 1\) for each object in \(\mcc\).
    There is a morphism \((A, \morph{!_A}{A}{1}) \to (B, \morph{!_B}{B}{1})\) in
    \(\mcc \slice 1\) for every morphism \(\morph{f}{A}{B}\) in \(\mcc\) such
    that \(f \seq !_B = !_A\); since both \(f \seq !_B\) and \(!_A\) are
    morphisms \(A \to 1\) this condition holds for any morphism \(f\) in
    \(\mcc\).
    Therefore \(\mcc \cong \mcc \slice 1\).
\end{proof}

The strategy for this proof is much the same as that used in
\cref{thm:frobc-iso-finset-slice-c}, but relies on one small observation.

\begin{lemma}
    \label{lem:finsetprop-finite}
    Let \(C \in \finsetprop\) be a finite cardinal.
    Then \(\finsetpropwithnat \slice C \cong \finsetprop \slice C\).
\end{lemma}
\begin{proof}
    The morphisms in \(\finsetpropwithnat \slice C\) are the morphisms
    \([m] \to C\) for finite \(C\), which are precisely the morphisms of
    \(\finsetprop \slice C\).
\end{proof}

\begin{theorem}
    \label{thm:frobc-iso-hatfinset-slice-c}
    For a countable set of colours \(C\), there is an isomorphism of coloured
    PROPs \(\frobc{C} \cong \csp{\finsetpropwithnat \slice C}\).
\end{theorem}
\begin{proof}
    The proof is almost the same as \cref{thm:frobc-iso-finset-slice-c} but with
    the addition of \cref{lem:finsetprop-finite}.
    We have that \[
        \frobc{C}
        :=
        \sum_{c \in C}\frob
        \cong
        \sum_{c \in C}\csp{\finsetprop}
        \cong
        \sum_{c \in C}\csp{\finsetprop \slice 1}
        \cong
        \sum_{c \in C}\csp{\finsetpropwithnat \slice 1}.
    \]
    In the other direction we still have that \(
        \csp{\finsetpropwithnat \slice C}
        \cong
        \csp{\finsetpropwithnat \slice \sum_{c \in C} 1}
    \) as \(C\) is still countable.
    As before we need to show that \(
        \sum_{c \in C}\csp{\finsetpropwithnat \slice 1}
        \cong
        \csp{\finsetpropwithnat \slice \sum_{c \in C} 1}
    \), which follows by the same reasoning as in the prequel.
\end{proof}


\begin{theorem}[\cite{bonchi2022string}, Thm. 3.8]
    \label{thm:cospan-homomorphism}
    Let \(\mathbb{X}\) be a PROP whose monoidal product is a coproduct,
    \(\mathbf{C}\) a category with pushouts and an initial object, and
    \(\morph{F}{\mathbb{X}}{\mathbf{C}}\) a coproduct-preserving functor.
    Then there is a homomorphism of PROPs \(
        \morph{\tilde{F}}{\csp{\mathbb{X}}}{\csp[F]{\mathbf{C}}}
    \) that sends \(\cospan{\listvar{m}}[f]{X}[g]{\listvar{{n}}}\) to
    \(\cospan{F\listvar{m}}[Ff]{FX}[Fg]{F\listvar{n}}\).
    If \(F\) is full and faithful, then \(\tilde{F}\) is faithful.
\end{theorem}


\begin{corollary}[\cite{bonchi2022string}, Cor. 3.9]
    \label{cor:finset-to-hyp}
    There is a faithful PROP homomorphism
    \(\morph{\tilde{\pickinterfacesc{C}}}{\csp{\finsetpropwithnat}}{\cspdchyp}\)
\end{corollary}

\begin{definition}
    Let \(\morph{\frobtohypsigmac}{\frobc{C}}{\cspdchyp}\) be the PROP morphism
    defined by using \cref{thm:frobc-iso-hatfinset-slice-c} followed by
    \cref{cor:finset-to-hyp}.
\end{definition}


\subsection{From terms to graphs}

Our goal is to map from terms in \(\hypcsigmac\) into cospans in \(\cspdchyp\).

\begin{definition}[\cite{bonchi2022string}, Sec. 4.1]\label{def:hyp-morphisms}
    Let \(\morph{\termtohypsigmac}{\smcsigmac}{\cspdchyp}\) be a coloured PROP
    morphism with its action on generators defined as
    \begin{gather*}
        \termtohypsigmac[\iltikzfig{%
                strings/category/generator%
            }[box=\phi,colour=white,dom=\listvar{m},cod=\listvar{n}]
        ]
        :=
        \cospan{\listvar{m}}{\iltikzfig{graphs/terms/generator}}{\listvar{n}}
    \end{gather*}
    \todo[inline]{Coloured version of generator map somehow?}
\end{definition}

This means we can map from both generators of symmetric monoidal terms and the
Frobenius structure to cospans of hypergraphs.
Therefore to map from Frobenius terms, we simply put them together.

\begin{definition}
    Let \(
        \morph{\termandfrobtohypsigmac}{\smcsigmac + \frobs}{\cspdchyp}
    \) be the copairing of \(\termtohypsigmac\) and
    \(\frobtohypsigmac\).
\end{definition}

\begin{proposition}[\cite{bonchi2022string}, ]

\end{proposition}

\begin{proposition}[\cite{bonchi2022string}]\label{prop:tohyp-faithful}
    \(\termtohypsigmac\) and \(\frobtohypsigmac\) are faithful
\end{proposition}
\begin{proof}

\end{proof}

\todo[inline]{Adapt from FSCD paper section 2}